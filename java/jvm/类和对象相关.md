# 类和对象相关

## 类文件结构

## 类加载器

## 类加载过程

## 对象结构

- HotSpot 虚拟机里对象在堆内存中的存储布局分为 3 个部分：对象头（Header），实例数据（Instance Data）和对齐填充部分
- 对象头包括两部分：
  1. 自身运行时数据，也叫 **Mark Word**，包括哈希码，GC分代年龄，锁状态标志，线程持有的锁，偏向线程ID，偏向时间戳等
  2. 类型指针，指向其类型元数据，可以通过这个指针确定该对象时哪个类的实例，但并不一定所有的虚拟机实现都必须保留类型指针，也就是说查询对象的元数据不一定要经过对象本身
- 实例数据：真正存储的有效信息，代码里写的各种类型字段内容，无论是父类的还是自己的都有
- 对齐填充部分：不是必然存在，只起占位作用，用来保证对象所占空间一定是 8 字节的整数倍

## 对象 4 种引用

### 强引用

* 就是传统引用的定义，Object A = new Object（）；只要强引用存在，对象就永远不会被 GC

### 软引用

* jdk1.2 后提供了 SoftReference 类来实现软引用，系统要发生 OOM 前，会把软引用的对象列进回收范围进行第二次回收，如果第二次回收后还没足够内存，才会报 OOM

### 弱引用

* jdk1.2 后提供了 WeakReference 类来实现弱引用，被弱引用关联的对象，只能生存到下一次 GC，下一次 GC 一定会回收弱引用对象，无论内存够不够

### 虚引用

* jdk1.2 后提供了 PhantomReference 类来实现虚引用，对象是否存在虚引用不影响其生存时间，也无法通过虚引用获取对象实例，设置虚引用的唯一目的就是为了能在对象被回收时收到一个系统通知